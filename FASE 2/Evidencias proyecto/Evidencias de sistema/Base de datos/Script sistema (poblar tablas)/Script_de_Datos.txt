-- =====================================================
-- DENTAPLUS - SCRIPT COMPLETO (MySQL)
-- Crea la BD, tablas (Django + modelo tipo Sakila), vistas y datos de ejemplo
-- =====================================================

DROP DATABASE IF EXISTS dentaplus;
CREATE DATABASE dentaplus CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
USE dentaplus;

-- =====================================================
-- TABLAS DE SOPORTE DE Django (esenciales)
-- =====================================================

-- django_content_type
CREATE TABLE django_content_type (
    id INT AUTO_INCREMENT PRIMARY KEY,
    app_label VARCHAR(100) NOT NULL,
    model VARCHAR(100) NOT NULL,
    UNIQUE KEY django_content_type_app_label_model_76bd3d3b_uniq (app_label, model)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- django_migrations
CREATE TABLE django_migrations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    app VARCHAR(255) NOT NULL,
    name VARCHAR(255) NOT NULL,
    applied DATETIME NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- django_session
CREATE TABLE django_session (
    session_key VARCHAR(40) NOT NULL PRIMARY KEY,
    session_data TEXT NOT NULL,
    expire_date DATETIME NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- django_admin_log
CREATE TABLE django_admin_log (
    id INT AUTO_INCREMENT PRIMARY KEY,
    action_time DATETIME NOT NULL,
    user_id INT NOT NULL,
    content_type_id INT NULL,
    object_id TEXT NULL,
    object_repr VARCHAR(200) NOT NULL,
    action_flag SMALLINT NOT NULL,
    change_message TEXT NOT NULL,
    INDEX django_admin_log_user_id_idx (user_id),
    INDEX django_admin_log_content_type_id_idx (content_type_id),
    FOREIGN KEY (content_type_id) REFERENCES django_content_type(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- =====================================================
-- AUTH: grupos, permisos, usuarios (Django-ish)
-- =====================================================

CREATE TABLE auth_group (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(150) NOT NULL UNIQUE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE auth_permission (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    content_type_id INT NOT NULL,
    codename VARCHAR(100) NOT NULL,
    UNIQUE KEY auth_permission_content_type_id_codename (content_type_id, codename),
    FOREIGN KEY (content_type_id) REFERENCES django_content_type(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE auth_user (
    id INT AUTO_INCREMENT PRIMARY KEY,
    password VARCHAR(255) NOT NULL,
    last_login DATETIME NULL,
    is_superuser BOOLEAN NOT NULL DEFAULT FALSE,
    username VARCHAR(150) NOT NULL UNIQUE,
    first_name VARCHAR(30) NOT NULL,
    last_name VARCHAR(150) NOT NULL,
    email VARCHAR(254) NOT NULL,
    is_staff BOOLEAN NOT NULL DEFAULT FALSE,
    is_active BOOLEAN NOT NULL DEFAULT TRUE,
    date_joined DATETIME NOT NULL,
    CONSTRAINT auth_user_username_key UNIQUE (username)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE auth_user_groups (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    group_id INT NOT NULL,
    UNIQUE KEY auth_user_groups_user_group (user_id, group_id),
    FOREIGN KEY (user_id) REFERENCES auth_user(id),
    FOREIGN KEY (group_id) REFERENCES auth_group(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE auth_user_user_permissions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    permission_id INT NOT NULL,
    UNIQUE KEY auth_user_user_permissions_user_permission (user_id, permission_id),
    FOREIGN KEY (user_id) REFERENCES auth_user(id),
    FOREIGN KEY (permission_id) REFERENCES auth_permission(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE auth_group_permissions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    group_id INT NOT NULL,
    permission_id INT NOT NULL,
    UNIQUE KEY auth_group_permissions_group_permission (group_id, permission_id),
    FOREIGN KEY (group_id) REFERENCES auth_group(id),
    FOREIGN KEY (permission_id) REFERENCES auth_permission(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- =====================================================
-- TABLAS PRINCIPALES TIPO SAKILA / DENTAPLUS
-- (country, city, address, store, staff, customer, category, film, film_category, film_actor... )
-- =====================================================

-- country
CREATE TABLE country (
    country_id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    country VARCHAR(50) NOT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- city
CREATE TABLE city (
    city_id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    city VARCHAR(50) NOT NULL,
    country_id SMALLINT UNSIGNED NOT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (country_id) REFERENCES country(country_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- address
CREATE TABLE address (
    address_id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    address VARCHAR(255) NOT NULL,
    address2 VARCHAR(255) DEFAULT NULL,
    district VARCHAR(50) DEFAULT NULL,
    city_id SMALLINT UNSIGNED NOT NULL,
    postal_code VARCHAR(20) DEFAULT NULL,
    phone VARCHAR(20) DEFAULT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (city_id) REFERENCES city(city_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- store (clínicas / sucursales)
CREATE TABLE store (
    store_id TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    manager_staff_id TINYINT UNSIGNED DEFAULT NULL,
    address_id SMALLINT UNSIGNED NOT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (address_id) REFERENCES address(address_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- language (por compatibilidad con sakila)
CREATE TABLE language (
    language_id TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(20) NOT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- category (tratamientos/servicios)
CREATE TABLE category (
    category_id TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(25) NOT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- actor (personal clínico u operadores)
CREATE TABLE actor (
    actor_id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(45) NOT NULL,
    last_name VARCHAR(45) NOT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- film (tratamientos/servicios)
CREATE TABLE film (
    film_id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    release_year YEAR NULL,
    language_id TINYINT UNSIGNED DEFAULT NULL,
    rental_duration TINYINT UNSIGNED DEFAULT 1,
    rental_rate DECIMAL(5,2) DEFAULT 0.00,
    length SMALLINT UNSIGNED DEFAULT NULL,
    replacement_cost DECIMAL(7,2) DEFAULT 0.00,
    rating VARCHAR(10) DEFAULT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (language_id) REFERENCES language(language_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- film_category (m-n entre film y category)
CREATE TABLE film_category (
    film_id SMALLINT UNSIGNED NOT NULL,
    category_id TINYINT UNSIGNED NOT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (film_id, category_id),
    FOREIGN KEY (film_id) REFERENCES film(film_id),
    FOREIGN KEY (category_id) REFERENCES category(category_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- film_actor (m-n entre film y actor)
CREATE TABLE film_actor (
    actor_id SMALLINT UNSIGNED NOT NULL,
    film_id SMALLINT UNSIGNED NOT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (actor_id, film_id),
    FOREIGN KEY (actor_id) REFERENCES actor(actor_id),
    FOREIGN KEY (film_id) REFERENCES film(film_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- inventory (inventario de tratamientos / programación)
CREATE TABLE inventory (
    inventory_id INT AUTO_INCREMENT PRIMARY KEY,
    film_id SMALLINT UNSIGNED NOT NULL,
    store_id TINYINT UNSIGNED NOT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (film_id) REFERENCES film(film_id),
    FOREIGN KEY (store_id) REFERENCES store(store_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- staff (personal administrativo/recepcion)
CREATE TABLE staff (
    staff_id TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(45) NOT NULL,
    last_name VARCHAR(45) NOT NULL,
    address_id SMALLINT UNSIGNED DEFAULT NULL,
    email VARCHAR(50) DEFAULT NULL,
    store_id TINYINT UNSIGNED DEFAULT NULL,
    active BOOLEAN NOT NULL DEFAULT TRUE,
    username VARCHAR(40) DEFAULT NULL,
    password VARCHAR(255) DEFAULT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (address_id) REFERENCES address(address_id),
    FOREIGN KEY (store_id) REFERENCES store(store_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- customer (pacientes)
CREATE TABLE customer (
    customer_id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    store_id TINYINT UNSIGNED DEFAULT NULL,
    first_name VARCHAR(45) NOT NULL,
    last_name VARCHAR(45) NOT NULL,
    email VARCHAR(50) DEFAULT NULL,
    address_id SMALLINT UNSIGNED DEFAULT NULL,
    active BOOLEAN NOT NULL DEFAULT TRUE,
    create_date DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (address_id) REFERENCES address(address_id),
    FOREIGN KEY (store_id) REFERENCES store(store_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- rental (registro reservas / utilización de inventario)
CREATE TABLE rental (
    rental_id INT AUTO_INCREMENT PRIMARY KEY,
    rental_date DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    inventory_id INT NOT NULL,
    customer_id SMALLINT UNSIGNED NOT NULL,
    return_date DATETIME DEFAULT NULL,
    staff_id TINYINT UNSIGNED DEFAULT NULL,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (inventory_id) REFERENCES inventory(inventory_id),
    FOREIGN KEY (customer_id) REFERENCES customer(customer_id),
    FOREIGN KEY (staff_id) REFERENCES staff(staff_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- payment (pagos)
CREATE TABLE payment (
    payment_id INT AUTO_INCREMENT PRIMARY KEY,
    customer_id SMALLINT UNSIGNED NOT NULL,
    staff_id TINYINT UNSIGNED DEFAULT NULL,
    rental_id INT DEFAULT NULL,
    amount DECIMAL(10,2) NOT NULL,
    payment_date DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (customer_id) REFERENCES customer(customer_id),
    FOREIGN KEY (staff_id) REFERENCES staff(staff_id),
    FOREIGN KEY (rental_id) REFERENCES rental(rental_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- sales_by_film_category (VIEW) - muestra ventas por categoría de tratamiento
CREATE VIEW sales_by_film_category AS
SELECT
    c.name AS category,
    f.title AS film_title,
    SUM(p.amount) AS total_sales
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
LEFT JOIN inventory i ON i.film_id = f.film_id
LEFT JOIN rental r ON r.inventory_id = i.inventory_id
LEFT JOIN payment p ON p.rental_id = r.rental_id
GROUP BY c.name, f.title;

-- sales_by_store (VIEW) - ventas por sucursal
CREATE VIEW sales_by_store AS
SELECT
    s.store_id,
    a.address AS store_address,
    SUM(p.amount) AS total_sales
FROM store s
JOIN address a ON s.address_id = a.address_id
LEFT JOIN inventory i ON i.store_id = s.store_id
LEFT JOIN rental r ON r.inventory_id = i.inventory_id
LEFT JOIN payment p ON p.rental_id = r.rental_id
GROUP BY s.store_id, a.address;

-- =====================================================
-- TABLAS ADICIONALES / COMPLEMENTARIAS DEL DIAGRAMA
-- (por ejemplo, tablas relacionadas con perfiles, reservas, etc. que aparecen en tu imagen)
-- =====================================================

-- core_profile (perfil extendido de usuario)
CREATE TABLE core_profile (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT DEFAULT NULL, -- opcionalmente link a auth_user
    rut VARCHAR(20) DEFAULT NULL,
    telefono VARCHAR(25) DEFAULT NULL,
    direccion VARCHAR(255) DEFAULT NULL,
    fecha_nacimiento DATE DEFAULT NULL,
    imagen VARCHAR(255) DEFAULT NULL,
    saldo DECIMAL(12,2) DEFAULT 0.00,
    last_update TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES auth_user(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- core_reserva (reservas / citas)
CREATE TABLE core_reserva (
    id INT AUTO_INCREMENT PRIMARY KEY,
    fecha DATE NOT NULL,
    hora TIME NOT NULL,
    motivo VARCHAR(255) DEFAULT NULL,
    estado VARCHAR(50) DEFAULT 'pendiente',
    usuario_id INT DEFAULT NULL, -- referencia a core_profile.id (o auth_user)
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (usuario_id) REFERENCES core_profile(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Otros: tablas de logs o utilitarias que aparecen en diagramas Django
CREATE TABLE django_lock ( -- tabla ejemplo - opcional en muchos esquemas
    id INT AUTO_INCREMENT PRIMARY KEY,
    locked_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    name VARCHAR(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- =====================================================
-- INSERTS DE EJEMPLO: países, ciudades, direcciones, tiendas, idiomas, categorías, actores, films, inventory, staff, customer, rental, payment
-- =====================================================

-- countries
INSERT INTO country (country) VALUES
('Chile'), ('Argentina'), ('Perú'), ('Brasil');

-- cities
INSERT INTO city (city, country_id) VALUES
('Santiago', 1),
('Valparaíso', 1),
('Buenos Aires', 2),
('Lima', 3);

-- addresses
INSERT INTO address (address, district, city_id, postal_code, phone) VALUES
('Av. Providencia 123', 'Providencia', 1, '7500000', '+56987654321'),
('Calle Condell 200', 'Centro', 2, '2340000', '+56991234567'),
('Calle Falsa 123', 'Palermo', 3, 'C1010', '+541112345678'),
('Av. Arequipa 456', 'Miraflores', 4, '15074', '+5112345678');

-- stores
INSERT INTO store (manager_staff_id, address_id) VALUES
(NULL, 1),
(NULL, 2);

-- languages
INSERT INTO language (name) VALUES
('Spanish'), ('English');

-- categories (tratamientos)
INSERT INTO category (name) VALUES
('Ortodoncia'), ('Implantes'), ('Limpieza'), ('Blanqueamiento');

-- actors (personal clínico)
INSERT INTO actor (first_name, last_name) VALUES
('Carlos', 'Muñoz'),
('Daniela', 'López'),
('Andrés', 'García');

-- films (tratamientos/servicios)
INSERT INTO film (title, description, release_year, language_id, rental_duration, rental_rate, length, replacement_cost, rating)
VALUES
('Limpieza Dental', 'Limpieza profunda con ultrasonido', 2024, 1, 1, 25000.00, 30, 40000.00, 'A'),
('Blanqueamiento Avanzado', 'Blanqueamiento con sesión y guardas', 2023, 1, 1, 60000.00, 45, 80000.00, 'A'),
('Implante Unitario', 'Implante dental con tornillo y corona', 2022, 1, 1, 150000.00, 90, 200000.00, 'A');

-- film_category
INSERT INTO film_category (film_id, category_id) VALUES
(1, 3), -- Limpieza -> Limpieza
(2, 4), -- Blanqueamiento -> Blanqueamiento
(3, 2); -- Implante -> Implantes

-- film_actor (quién realiza el servicio)
INSERT INTO film_actor (actor_id, film_id) VALUES
(1, 1), (2, 2), (3, 3);

-- inventory (cada tratamiento disponible por tienda)
INSERT INTO inventory (film_id, store_id) VALUES
(1, 1),
(2, 1),
(3, 2);

-- staff (recepcionistas / admin)
INSERT INTO staff (first_name, last_name, address_id, email, store_id, active, username, password)
VALUES
('Ana', 'Contreras', 1, 'ana.contreras@dentaplus.cl', 1, TRUE, 'anaC', 'pbkdf2_sha256$260000$EXAMPLE$EXAMPLEHASH'),
('Luis', 'Mendez', 2, 'luis.mendez@dentaplus.cl', 2, TRUE, 'luisM', 'pbkdf2_sha256$260000$EXAMPLE2$EXAMPLEHASH2');

-- customers (pacientes)
INSERT INTO customer (store_id, first_name, last_name, email, address_id, active)
VALUES
(1, 'Matías', 'Salinas', 'matias.salinas@example.com', 1, TRUE),
(1, 'Sofía', 'Reyes', 'sofia.reyes@example.com', 2, TRUE);

-- rentals (reservas con relación a inventory)
INSERT INTO rental (inventory_id, customer_id, return_date, staff_id)
VALUES
(1, 1, '2025-10-18 11:00:00', 1),
(2, 2, '2025-10-21 12:00:00', 2);

-- payments
INSERT INTO payment (customer_id, staff_id, rental_id, amount, payment_date)
VALUES
(1, 1, 1, 25000.00, '2025-10-18 10:40:00'),
(2, 2, 2, 60000.00, '2025-10-21 11:45:00');

-- core_profile (perfiles de usuarios, vinculado a auth_user opcionalmente)
INSERT INTO core_profile (user_id, rut, telefono, direccion, fecha_nacimiento, saldo)
VALUES
(NULL, '20.111.333-4', '+56998765432', 'Av. Matta 123', '1998-05-12', 15000.00),
(NULL, '19.222.444-5', '+56991234567', 'Los Leones 456', '2000-10-01', 8000.00);

-- core_reserva (reservas de ejemplo)
INSERT INTO core_reserva (fecha, hora, motivo, estado, usuario_id)
VALUES
('2025-10-25', '10:30:00', 'Control dental', 'confirmada', 1),
('2025-10-26', '12:00:00', 'Limpieza', 'pendiente', 2);

-- =====================================================
-- INSERTS EN TABLAS DJANGO-RELATED (ejemplos mínimos)
-- =====================================================

-- content types ejemplo
INSERT INTO django_content_type (app_label, model) VALUES
('auth', 'user'),
('core', 'profile'),
('core', 'reserva');

-- permisos ejemplo
INSERT INTO auth_permission (name, content_type_id, codename)
VALUES
('Can add user', 1, 'add_user'),
('Can change user', 1, 'change_user'),
('Can delete user', 1, 'delete_user');

-- grupo ejemplo
INSERT INTO auth_group (name) VALUES ('administradores'), ('recepcion');

-- django_migrations (registro de migraciones de ejemplo)
INSERT INTO django_migrations (app, name, applied) VALUES
('auth', '0001_initial', NOW()),
('core', '0001_initial', NOW());

-- =====================================================
-- USUARIO ADMIN DE EJEMPLO (auth_user)
-- - Username: admin
-- - Email: admin@dentaplus.local
-- - Contraseña: cambia esto luego desde Django (ejemplo no usable por defecto)
-- =====================================================

-- Nota: el valor password aquí es un placeholder. Reemplaza el hash por uno válido de Django
-- si quieres iniciar sesión con django admin. Alternativamente, crea superuser desde Django.
INSERT INTO auth_user (password, last_login, is_superuser, username, first_name, last_name, email, is_staff, is_active, date_joined)
VALUES
('pbkdf2_sha256$260000$PLACEHOLDERSALT$PLACEHOLDERHASH', NULL, TRUE, 'admin', 'Admin', 'Dentaplus', 'admin@dentaplus.local', TRUE, TRUE, NOW());

-- Si quieres crear un usuario Django válido desde SQL puedes generar el hash apropiado y actualizar la fila:
-- UPDATE auth_user SET password = '<django_pbkdf2_hash>' WHERE username = 'admin';

-- =====================================================
-- VISTAS ADICIONALES / EJEMPLOS
-- (otras vistas que suelen aparecer en diagramas Sakila / Django)
-- =====================================================

-- view: customer_balance (saldo por cliente sumando pagos menos consumos) - esquema demostrativo
CREATE VIEW customer_balance AS
SELECT
    c.customer_id,
    c.first_name,
    c.last_name,
    IFNULL(SUM(p.amount), 0) AS total_paid
FROM customer c
LEFT JOIN payment p ON p.customer_id = c.customer_id
GROUP BY c.customer_id, c.first_name, c.last_name;

-- =====================================================
-- ÍNDICES OPCIONALES (mejoran consultas)
-- =====================================================

CREATE INDEX idx_film_title ON film(title);
CREATE INDEX idx_customer_last_name ON customer(last_name);
CREATE INDEX idx_payment_date ON payment(payment_date);

-- =====================================================
-- FIN DEL SCRIPT
-- =====================================================

